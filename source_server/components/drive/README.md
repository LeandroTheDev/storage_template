# Wiki

Headers are not necessary for logins.

All request you do to the server that needs any authentication needs this header:
```
'auth': '123...',
'username': 'user',
```
The wrong token or username will return the 401 error

All contents in the headers needs to be encrypted and needs to be decrypted by the server, if a content is not encrypted in the header it will just return a internal server error. (except for the username, should not be encrypted, this is necessary because the encryption keys is stored based on username)

The auth, needs to have the actual client timestamp, "123123123123-timestamp", if the timestamp is different from the server the client will receive a 401 error, 10 seconds limiar

### Pointers
``/drive/requestkey (GET)``: request the public key for encrypting the password used in login
```json
headers: {
    "username": "test"
}

returns: {
    "error": false,
    "message": "-----BEGIN PUBLIC KEY-----" // Will be only used for the login and can be discarted after using "login"
}
```

``/drive/login (POST)``: login in the storage
```json
body: {
    "username": "test",
    "password": "ASFASIFOANFIOANFS", // Encrypted by the public key received from "requestkey"
    "publickey": "-----BEGIN PUBLIC KEY-----" // Client Generated public key for the server to encrypt for the client
}

returns: {
    "error": false,
    // The message is encrypted with public key received from the client (only the values not the keys)
    "message": {
        "auth": 123, // Random number generated by the server
        "publickey": "-----BEGIN PUBLIC KEY-----", // Server Generated public key for the client to encrypt requests for the server
        "created": "12312541" // Timestamp when the token is created
    }
}
```

## Requests below requires ``auth`` parameters to be encrypted with the public key provided by the server in previous requests

``/drive/requestfile (GET)``: request the file to enable downloading, example: address/requestfile?directory=/test.mp4
```json
headers: {
    "username": "test",
    "auth": "123..."
}

returns: {
    "error": false,
    "message": "The File has been requested, you can now access it"
}
```

``/drive/getfile (GET)``: download the file, example: address/getfile?directory=/test.mp4
```json
query: {
    "directory": "/test.mp4"
}

returns: stream pipe
```

``/drive/getfolders (GET)``: returns "folder": [], "files": [], example: address/getfolders?directory=/myfolder
```json
query: {
    "directory": "/test.mp4"
}

headers: {
    "username": "test",
    "auth": "123..."
}

returns: {
    "folders": [],
    "files": []
}
```

``/drive/requestImage (GET)``: request the image to enable in your ip address (returns a success code, use getImage after), example: address/requestImage?directory=/image/test.png
```json
query: {
    "directory": "/test.png"
}

headers: {
    "username": "test",
    "auth": "123..."
}

returns: {
    "error": false,
    "message": "The Image has been requested, you can now access it"
}
```

``/drive/getImage (GET)``: returns the image array bytes via stream, if avaiable to your ip address, address/getImage?directory=/image/test.png
```json
query: {
    "directory": "/test.png"
}

returns: stream pipe
```

``/drive/requestVideo (GET)``: request the video to enable in your ip address (returns a success code, use getVideo after), example: address/requestVideo?directory=/movies/dereguejhonsons.mp4
```json
query: {
    "directory": "/test.mp4"
}

headers: {
    "username": "test",
    "auth": "123..."
}

returns: {
    "error": false,
    "message": "The video has been requested, you can now access it"
}
```

``/drive/getVideo (GET)``: stream the requested video, if avaiable to your ip address, example: address/getVideo?directory=/movies/
```json
query: {
    "directory": "/test.png"
}

returns: stream pipe
```

``/drive/createfolder (GET)``: create a folder in selected location, example: { directory: "/myfolder" }
```json
query: {
    "directory": "/test.mp4"
}

headers: {
    "username": "test",
    "auth": "123..."
}

returns: {
    "error": false,
    "message": "Success"
}
```

``/drive/uploadfile (POST)``: upload a file in selected folder, example: formData Body: { saveDirectory: "/movies/jhonsons.mp4 }, you need to send the files as the form data default
```json
headers: {
    "username": "test",
    "auth": "123..."
}

formData: {
    "saveDirectory": "/",
}

returns: {
    "error": false,
    "message": "Success"
}
```

``/drive/delete (DELETE)``: delete a folder or file selected, example: address/delete?item=/movies/jhonsons.mp4 OR address/delete?item=/movies
```json
query: {
    "item": "/test.mp4"
}

headers: {
    "username": "test",
    "auth": "123..."
}

returns: {
    "error": false,
    "message": "Success"
}
```

``/drive/downloadvideo (POST)``: download a video from a specific url
```json
headers: {
    "username": "test",
    "auth": "123..."
}

body: {
    "videoLink": "https://youtube.com/123",
    "videoName": "myvideo.mp4",
    "directory": "/"
}

returns: {
    "error": false,
    "message": "Success"
}
```

Success pointers will reset the internal DDOS protection